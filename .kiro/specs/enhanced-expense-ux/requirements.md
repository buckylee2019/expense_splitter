# 需求文件

## 簡介

此功能旨在透過改善使用者介面、簡化工作流程以及增加直覺的視覺回饋，來強化 SplitX 的費用管理功能。目前系統已具備費用追蹤、分帳設定、多付款人及分類管理等功能，但使用者體驗可透過更好的視覺設計、更清晰的資訊層級、簡化的輸入流程以及增強的行動裝置響應性來大幅改善。

## 術語表

- **費用系統（Expense System）**：SplitX 應用程式中負責建立、編輯、檢視和管理共同費用的元件
- **分帳設定（Split Configuration）**：使用平均分配、權重分配或自訂分配方式，將費用金額分配給群組成員的機制
- **付款人介面（Payer Interface）**：允許使用者選擇單一或多位付款人的使用者介面元件
- **分類選擇器（Category Selector）**：用於選擇費用類別和子類別的階層式介面
- **餘額指示器（Balance Indicator）**：顯示使用者在費用中的債務/債權狀態的視覺元素
- **表單驗證（Form Validation）**：驗證使用者輸入和分帳計算的即時回饋系統
- **行動介面（Mobile Interface）**：為行動裝置互動設計的觸控優化使用者介面元件
- **視覺回饋（Visual Feedback）**：透過動畫、顏色和圖示對使用者操作提供即時回應的使用者介面元素

## Requirements

### 需求 1：簡化費用建立流程

**使用者故事：** 身為使用者，我希望能以最少的步驟快速新增費用，以便有效率地記錄交易而不感到挫折

#### 驗收標準

1. WHEN 使用者導航至新增費用頁面時，THE 費用系統 SHALL 在桌面裝置上顯示單頁表單，所有欄位無需捲動即可看見
2. WHEN 使用者輸入金額時，THE 費用系統 SHALL 自動計算並即時顯示分帳金額
3. WHEN 使用者選擇分類時，THE 費用系統 SHALL 記住最後使用的分類，供下次建立費用時使用
4. WHERE 使用者曾建立過費用，THE 費用系統 SHALL 以最常使用的付款人預先填入付款人欄位
5. WHEN 使用者提交包含無效資料的表單時，THE 費用系統 SHALL 在 100 毫秒內於相關欄位旁顯示內嵌錯誤訊息

### 需求 2：強化分帳設定介面

**使用者故事：** 身為使用者，我希望能以直覺的方式設定費用分帳並獲得清晰的視覺回饋，以便準確分配費用而不感到困惑

#### 驗收標準

1. WHEN 使用者開啟分帳設定時，THE 費用系統 SHALL 顯示視覺化預覽，呈現每位成員的分帳比例和絕對金額
2. WHEN 使用者在自訂模式下調整分帳金額時，THE 費用系統 SHALL 顯示即時進度條，呈現已分配與剩餘金額
3. WHEN 分帳總額與費用金額不符時，THE 費用系統 SHALL 以紅色指示器和具體錯誤訊息標示差異
4. WHEN 使用者在平均分帳模式下切換成員時，THE 費用系統 SHALL 以持續 200 毫秒的平滑轉場動畫呈現金額重新分配
5. WHERE 使用者選擇權重分帳時，THE 費用系統 SHALL 顯示視覺化比例指示器，呈現相對分帳大小

### 需求 3：改善分類選擇體驗

**使用者故事：** 身為使用者，我希望能透過視覺提示快速選擇費用分類，以便準確分類費用而無需搜尋

#### 驗收標準

1. WHEN 使用者開啟分類選擇器時，THE 費用系統 SHALL 以網格佈局顯示帶有色彩編碼圖示的分類
2. WHEN 使用者搜尋分類時，THE 費用系統 SHALL 即時篩選結果並標示符合的文字
3. WHEN 使用者選擇常用分類時，THE 費用系統 SHALL 在頂部的「最近使用」區域顯示該分類
4. WHEN 使用者檢視子分類時，THE 費用系統 SHALL 以視覺階層顯示父分類的脈絡
5. WHERE 使用者尚未選擇分類，THE 費用系統 SHALL 在表單提交前顯示醒目的視覺提醒

### 需求 4：強化多付款人介面

**使用者故事：** 身為使用者，我希望能輕鬆地在多位付款人之間分配付款並清楚追蹤金額，以便準確記錄複雜的付款情境

#### 驗收標準

1. WHEN 使用者選擇多付款人模式時，THE 費用系統 SHALL 顯示專用畫面，為每位成員提供金額輸入欄位
2. WHEN 使用者輸入付款人金額時，THE 費用系統 SHALL 在固定標題列中顯示累計總額和剩餘金額
3. WHEN 已付總額超過費用金額時，THE 費用系統 SHALL 顯示「超額付款」警告及超額金額
4. WHEN 已付總額少於費用金額時，THE 費用系統 SHALL 以強調色顯示剩餘金額
5. WHEN 使用者完成付款人選擇時，THE 費用系統 SHALL 顯示摘要，呈現所有付款人及其付款金額

### 需求 5：改善費用詳情視覺化

**使用者故事：** 身為使用者，我希望能檢視費用詳情並清楚看到付款和分帳的視覺化分解，以便一目了然地了解誰付了多少、誰欠了多少

#### 驗收標準

1. WHEN 使用者檢視費用詳情時，THE 費用系統 SHALL 以視覺化卡片佈局顯示，並為付款人和分帳設置明確區塊
2. WHEN 費用有多位付款人時，THE 費用系統 SHALL 在醒目區塊中顯示每位付款人及其付款金額
3. WHEN 使用者檢視分帳明細時，THE 費用系統 SHALL 以色彩編碼的餘額指示器（正值、負值、已結清）顯示每位成員的分帳金額
4. WHEN 使用者參與該費用時，THE 費用系統 SHALL 以明顯的背景色標示其所在列
5. WHERE 使用者在該費用中有淨餘額，THE 費用系統 SHALL 以適當的正值或負值樣式醒目顯示

### 需求 6：行動裝置觸控互動最佳化

**使用者故事：** 身為行動裝置使用者，我希望有適當大小和手勢的觸控友善介面，以便在手機上舒適地管理費用

#### 驗收標準

1. WHEN 使用者在行動裝置上與表單輸入互動時，THE 費用系統 SHALL 顯示最小高度為 44 像素的輸入欄位作為觸控目標
2. WHEN 使用者在行動裝置上開啟彈出選擇器時，THE 費用系統 SHALL 以平滑的向上滑動動畫顯示全螢幕覆蓋層
3. WHEN 使用者在行動裝置上調整分帳金額時，THE 費用系統 SHALL 在數字輸入旁提供增加/減少按鈕
4. WHEN 使用者在行動裝置上捲動費用清單時，THE 費用系統 SHALL 實作下拉更新手勢以更新資料
5. WHERE 行動裝置鍵盤可見時，THE 費用系統 SHALL 調整視窗以保持作用中的輸入欄位在鍵盤上方可見

### 需求 7：即時表單驗證與回饋

**使用者故事：** 身為使用者，我希望能立即獲得表單錯誤和驗證問題的回饋，以便在提交前修正錯誤

#### 驗收標準

1. WHEN 使用者輸入無效金額時，THE 費用系統 SHALL 在 100 毫秒內於欄位下方顯示錯誤訊息
2. WHEN 使用者的分帳設定無效時，THE 費用系統 SHALL 停用提交按鈕並顯示具體的驗證錯誤
3. WHEN 使用者修正驗證錯誤時，THE 費用系統 SHALL 在 100 毫秒內移除錯誤訊息並重新啟用提交功能
4. WHEN 表單有多個錯誤時，THE 費用系統 SHALL 同時顯示所有錯誤並清楚關聯至對應欄位
5. WHERE 使用者嘗試提交有錯誤的表單，THE 費用系統 SHALL 捲動至第一個錯誤欄位並聚焦

### 需求 8：強化視覺階層與資訊設計

**使用者故事：** 身為使用者，我希望費用資訊以清晰的視覺階層呈現，以便快速瀏覽並理解關鍵細節

#### 驗收標準

1. WHEN 使用者檢視費用表單時，THE 費用系統 SHALL 使用一致的排版，並在標籤、數值和輔助文字之間有清楚的大小區別
2. WHEN 使用者檢視費用清單時，THE 費用系統 SHALL 顯示費用卡片，包含醒目的金額、清晰的分類標籤和次要的詮釋資料
3. WHEN 使用者檢視餘額資訊時，THE 費用系統 SHALL 一致地使用色彩編碼（綠色表示債權、紅色表示債務、灰色表示已結清）
4. WHEN 使用者與互動元素互動時，THE 費用系統 SHALL 提供持續 150 毫秒的懸停狀態轉場
5. WHERE 使用者檢視複雜資料，THE 費用系統 SHALL 使用視覺分隔線和留白來建立清晰的內容分組

### 需求 9：改善日期與時間選擇

**使用者故事：** 身為使用者，我希望能以智慧預設值輕鬆選擇費用日期，以便以準確的時間戳記記錄費用

#### 驗收標準

1. WHEN 使用者建立新費用時，THE 費用系統 SHALL 預設日期為目前日期和時間
2. WHEN 使用者開啟日期選擇器時，THE 費用系統 SHALL 顯示日曆介面，並提供快速選擇選項（今天、昨天、上週）
3. WHEN 使用者選擇過去的日期時，THE 費用系統 SHALL 驗證日期不在未來
4. WHEN 使用者檢視費用時，THE 費用系統 SHALL 為近期費用顯示相對時間標籤（今天、昨天、3 天前）
5. WHERE 費用超過 7 天，THE 費用系統 SHALL 以一致的格式顯示完整日期

### 需求 10：智慧預設值與個人化

**使用者故事：** 身為使用者，我希望系統能記住我的偏好並提供智慧預設值，以便更快速地建立費用並減少重複輸入

#### 驗收標準

1. WHEN 使用者建立多筆費用時，THE 費用系統 SHALL 記住最後使用的幣別並預先選取
2. WHEN 使用者經常使用特定分帳設定時，THE 費用系統 SHALL 將其作為快速選擇範本提供
3. WHEN 使用者在群組中新增費用時，THE 費用系統 SHALL 預設將所有活躍成員納入平均分帳
4. WHERE 使用者對特定商家有偏好的分類，THE 費用系統 SHALL 根據描述關鍵字建議該分類
5. WHEN 使用者編輯費用時，THE 費用系統 SHALL 保留所有原始值並標示已變更的欄位

### 需求 11：無障礙與鍵盤導航

**使用者故事：** 身為依賴鍵盤導航的使用者，我希望能在不使用滑鼠的情況下完成所有費用操作，以便使用鍵盤快捷鍵有效率地工作

#### 驗收標準

1. WHEN 使用者以 Tab 鍵導航費用表單時，THE 費用系統 SHALL 以邏輯順序在所有互動元素間移動焦點
2. WHEN 使用者在彈出觸發器上按下 Enter 鍵時，THE 費用系統 SHALL 開啟彈出視窗並聚焦第一個互動元素
3. WHEN 使用者在彈出視窗中按下 Escape 鍵時，THE 費用系統 SHALL 關閉彈出視窗並將焦點返回觸發元素
4. WHEN 使用者以鍵盤導航分帳設定時，THE 費用系統 SHALL 提供方向鍵在成員列之間導航
5. WHERE 使用者聚焦於輸入欄位，THE 費用系統 SHALL 顯示 2 像素外框的可見焦點指示器

### 需求 12：載入狀態與效能回饋

**使用者故事：** 身為使用者，我希望在載入和處理操作期間獲得清楚的回饋，以便知道系統正在運作而非凍結

#### 驗收標準

1. WHEN 使用者提交費用表單時，THE 費用系統 SHALL 在提交按鈕上顯示載入指示器並停用該按鈕
2. WHEN 正在擷取費用資料時，THE 費用系統 SHALL 顯示符合內容佈局的骨架載入器
3. WHEN 正在處理分帳計算時，THE 費用系統 SHALL 在受影響的金額旁顯示細微的旋轉圖示
4. WHEN 操作成功完成時，THE 費用系統 SHALL 在導航前顯示成功訊息 2 秒
5. IF 操作失敗，THEN THE 費用系統 SHALL 顯示包含重試選項的錯誤訊息並保留使用者輸入
